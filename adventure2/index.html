<!DOCTYPE html>
<html>
  <head>
    <style>
      body{
  overflow: hidden;
}
.world-content {
  position: relative;
  width: 0px;
  height: 0px;

  div {
    position: absolute;
    background-color: black;
  }
}

.world {
  position: fixed;
  width: 100%;
  height: 100%;
  top: 0px;
  left: 0px;
  overflow: hidden;
}

.ground {
  position: absolute;
  top: 0px;
  left: 0px;
  width: var(--mapSizeXPx);
  height: var(--mapSizeYPx);
  background-image: url("../assets/images/wood.jpg");
}


.player {
  position: absolute;
  left: 0;
  top: 0;
  width: 10px;
  height: 10px;
  background-color: red;
  border-radius: 100%;
  transform: translate(-50%, -50%);
}

      
      :root {
        --cs: 100px;
      }

      .controls {
        position: fixed;
        bottom: 0px;
        left: 0%;
        display: grid;
        grid-template-rows: var(--cs);
        grid-template-columns: var(--cs) var(--cs);

        .angle, .motion {
          background-color: lightgray;
        }

        button {
          display: block;
          background: none;
          margin: 0;
          padding: 0;
          border: none;

          &:active span:hover {
            background-color: pink;
          }
        }

        .angle {
          display: grid;
          grid-template-rows: 1fr;
          grid-template-columns: 1fr 1fr;
        }
        .motion {
          position: relative;
          overflow: hidden;
          border-radius: 100%;
        }
        .motion .motion-grid {
          display: grid;
          grid-template-columns: 1fr 1fr;
          grid-template-rows: 1fr 1fr;
          width: 100%;
          height: 100%;
          transform: rotateZ(-45deg);
        }
        .middle-cover{
          width: 25%;
          height: 25%;
          position: absolute;
          left: 37.5%;
          top: 37.5%;
          border-radius: 100%;
          background-color: lightgray;
        }
        .cover {
          width: 0px;
          height: 0px;
          position: absolute;
          left: 50%;
          top: 50%;
          transform: scale(30);
          opacity: 0.1;

          .world-content div {
            /* expandera hitboxar för bättre kollision */
            border: 5px solid black;
            transform: translate(-5px, -5px);
          }
        }
      }

      
@property --world-rot-pos {
  syntax: "<number>";
  initial-value: 0;
  inherits: false;
}
@property --world-rot-neg {
  syntax: "<number>";
  initial-value: 0;
  inherits: false;
}
@property --world-move-x-pos {
  syntax: "<number>";
  initial-value: 0;
  inherits: false;
}
@property --world-move-x-neg {
  syntax: "<number>";
  initial-value: 0;
  inherits: false;
}
@property --world-move-y-pos {
  syntax: "<number>";
  initial-value: 0;
  inherits: false;
}
@property --world-move-y-neg {
  syntax: "<number>";
  initial-value: 0;
  inherits: false;
}

@keyframes rotate-pos { to { --world-rot-pos: 1; } }
@keyframes rotate-neg { to { --world-rot-neg: 1; } }
@keyframes move-x-pos { to { --world-move-x-pos: 1; } }
@keyframes move-x-neg { to { --world-move-x-neg: 1; } }
@keyframes move-y-pos { to { --world-move-y-pos: 1; } }
@keyframes move-y-neg { to { --world-move-y-neg: 1; } }

.world-anim {
  --mapSizeX: 1000;
  --mapSizeY: 1000;
  --mapSizeXPx: calc(var(--mapSizeX) * 1px);
  --mapSizeYPx: calc(var(--mapSizeY) * 1px);

  --moveTimeX: calc(var(--mapSizeX) / 100 * 1s);
  --moveTimeY: calc(var(--mapSizeY) / 100 * 1s);

  animation:
    rotate-pos 5s linear infinite,
    rotate-neg 5s linear infinite,
    move-x-pos var(--moveTimeX) linear infinite,
    move-x-neg var(--moveTimeX) linear infinite,
    move-y-pos var(--moveTimeY) linear infinite,
    move-y-neg var(--moveTimeY) linear infinite;
  animation-play-state: paused, paused, paused, paused, paused, paused;

  --world-rotation: rotate(calc((var(--world-rot-pos) - var(--world-rot-neg)) * -360deg));
  --world-translation: translate(
    calc(mod(var(--world-move-x-pos) - var(--world-move-x-neg) + 0.5, 1) * var(--mapSizeXPx) * -1), /*Is this correct?*/
    calc(mod(var(--world-move-y-pos) - var(--world-move-y-neg) + 0.5, 1) * var(--mapSizeYPx) * -1)
    );

  &:has(button:active .rot-r:hover) {
    animation-play-state: running, paused, paused, paused, paused, paused;
  }
  &:has(button:active .rot-l:hover) {
    animation-play-state: paused, running, paused, paused, paused, paused;
  }
  &:has(button:active .move-l:hover) {
    animation-play-state: paused, paused, running, paused, paused, paused;
  }
  &:has(button:active .move-r:hover) {
    animation-play-state: paused, paused, paused, running, paused, paused;
  }
  &:has(button:active .move-u:hover) {
    animation-play-state: paused, paused, paused, paused, running, paused;
  }
  &:has(button:active .move-d:hover) {
    animation-play-state: paused, paused, paused, paused, paused, running;
  }
}

.world-translation {
  transform: var(--world-translation);
}
.world-rotation {
  transform: var(--world-rotation);
}
.world-transform {
  transform: var(--world-rotation) var(--world-translation);
}

@keyframes animator {
from { width: 0px }
to { width: 100px }
}
.animator {
  animation: animator linear 1s infinite;
}

      .center{
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
}
.threeD{
        margin-top: 100px;
        margin-left: 100px;
        transform-style: preserve-3d;
        transform: perspective(100cm);
}

.threeD div{
        transform-style: preserve-3d;
        background-image: url("../assets/images/debug.png");
        background-size: 100%;
}

/*front*/
.cubed{
        height:var(--height) !important;
        width: var(--width) !important;
        background-image: var(--img);
        background-color: var(--color);
        transform-style: preserve-3d;
        /*(in)SANE DEFAULTS*/
        --width: 100px;
        --height: 100px;
        --depth: 100px;
        --img: none;
        --color: #000;
        --flipY: 0deg;
        /*
        DEBUG
        */
        /* 
        transform: perspective(100cm) rotate3D(1, 0, 1, 45deg);
        animation-name: debug;
        animation-iteration-count: infinite;
        animation-duration: 4s;
        animation-timing-function: linear;
*/
}


/* top */
.cubed > div:nth-child(1){
        position: absolute;
        top: calc(var(--depth) / 2);
        left: 50%;
        width: var(--width);
        height: var(--depth);
        transform: translate(-50%, -50%) rotateX(90deg) rotate(180deg) translate(0, -100%);
        transform-origin: 50% 0% 0;
}

/* bottom */
.cubed > div:nth-child(2){
        position: absolute;
        top: calc(var(--height) - var(--depth) / 2);
        left: 50%;
        width: var(--width);
        height: var(--depth);
        transform: translate(-50%, -50%) rotateX(-90deg);
        transform-origin: 50% 100% 0;
}

/* right */
.cubed > div:nth-child(3){
        position: absolute;
        top: 50%;
        left: calc(var(--width) - var(--height) / 2);
        width: var(--height); 
        height: var(--depth);
        transform: translate(-50%, -50%) rotateY(90deg) rotate(-90deg) translate(50%, -50%);
        transform-origin: 100% 50% 0;
}

/* left */
.cubed > div:nth-child(4){
        position: absolute;
        top: 50%;
        left: calc(var(--height) / 2);
        width: var(--height); 
        height: var(--depth);
        transform: translate(-50%, -50%) rotateY(-90deg) rotate(90deg) translate(-50%, -50%);
        transform-origin: 0% 50% 0;
}

/*back*/
.cubed > div:nth-child(5){
        position: absolute;
        top: 50%;
        left: 50%;
        height:var(--height);
        width: var(--width);
        transform: translate(-50%, -50%) translateZ(var(--depth));
}


@keyframes debug {
        from {transform: perspective(100cm) rotate3D(1, 1, 1, 0deg);}
        to {transform: perspective(100cm) rotate3D(1, 1, 1, 360deg);}
}

.cubed > div{
        transform-style: preserve-3d;
        background-image: var(--img);
        background-color: var(--color);
        transform: perspective(100cm);
        background-size: 100% 100%;
}

      .wall{
  --img:url("../assets/images/books.jpg");
}
.pole{
  transform: translateZ(100px);
}
.roof{
  transform: translateZ(var(--extra));
}

      .skyboxHolder{
  --skyboxSize: 10px;
  transform-style:preserve-3d;
  position: absolute;
  width:0px;
  height:0px;
  left:50%;
  top:50%;
  transform: perspective(var(--fov)) translateZ(calc(var(--fov) - var(--skyboxSize)/2));
  transition: transform 1s;
  .skybox{
    --img: linear-gradient(lightblue, blue); 
    position:absolute;
    left:calc(var(--skyboxSize)/-2);
    top:calc(var(--skyboxSize)/-2);
    --width:var(--skyboxSize);
    --height:var(--skyboxSize);
    --depth:var(--skyboxSize);
    transform-origin: 50% 50% calc(var(--skyboxSize)/2);
    transform: rotateX(90deg) var(--world-rotation);
    div:nth-child(5){
      background-image: none;
      background-color:lightblue;
    }
    background-image: none;
    background-color:blue;
  }
}

      :root{
  --fov: 10cm;
}
.world-inner {
  position: absolute;
  transform-origin: 50% 50%;
  transform-style: preserve-3d;
  transform:  perspective(var(--fov)) translateY(50px) translateZ(var(--fov)) rotateX(80deg) ;
  transition: transform 2s;
  top: 50%;
  left: 50%;
  width:0px;
  height:0px;
}

    </style>
  </head>
  <body>
    <div class="animator"></div>
    <div class="world-anim">
        <div class="skyboxHolder">
    <div class="skybox cubed">
      <div></div>
      <div></div>
      <div></div>
      <div></div>
      <div></div>
      <div></div>
    </div>
  </div>

      
      <div class="world">
        <div class="world-inner">
          <div class="player"></div>
          <div style="transform-style:preserve-3d" class="world-content world-transform" id="template-world">
            <!-- Världen -->
              <div style="left: 5px; top: 0px; width: 50px; height: 20px"></div>
            <div class="cubed wall" style=" left: 5px; top: 0px; --width: 50px; --height: 20px; --depth: 100px;"><div></div><div></div><div></div><div></div><div></div><div></div></div><div class="cubed wall" style=" left: 200px; top: 500px; --width: 80px; --height: 10px; --depth: 100px;"><div></div><div></div><div></div><div></div><div></div><div></div></div><div class="cubed wall" style=" left: 600px; top: 600px; --width: 80px; --height: 80px; --depth: 10000px;"><div></div><div></div><div></div><div></div><div></div><div></div></div><div class="cubed pole" style=" left: 680px; top: 600px; --width: 100px; --height: 20px; --depth: 100px;"><div></div><div></div><div></div><div></div><div></div><div></div></div><div class="cubed roof" style=" left: 680px; top: 620px; --width: 500px; --height: 500px; --depth: 10px; --extra: 200px;"><div></div><div></div><div></div><div></div><div></div><div></div></div>
            <div class="ground"></div>
          </div>
        </div>
      </div>

      
      <div class="controls">
        <button class="angle">
          <span class="rot-l"></span>
          <span class="rot-r"></span>
        </button>
        <button class="motion world-rotation">
          <div class="motion-grid">
            <span class="move-r"></span>
            <span class="move-d"></span>
            <span class="move-u"></span>
            <span class="move-l"></span>
          </div>
          <div class="middle-cover">
          </div>
          <div class="cover">
            <div class="world-content world-translation" id="template-world">
              <!-- Hitboxar -->
              <div style=" left: 5px; top: 0px; width: 50px; height: 20px"></div><div style=" left: 200px; top: 500px; width: 80px; height: 10px"></div><div style=" left: 600px; top: 600px; width: 80px; height: 80px"></div>
            </div>
          </div>
        </button>
      </div>

    </div>
  </body>
</html>
